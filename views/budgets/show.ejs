<%- include('../partials/header'); %>

<%
const paySchedules = [ 'Weekly', 'Bi-Weekly', 'Semi-Monthly', 'Monthly' ];
%>

<h2>Manage <%= budget.name %> Budget</h2>

<form action="/budgets/<%= budget.id %>?_method=PUT" method="POST">
    <label>
        Name <input type="text" name="name" value="<%= budget.name %>" />
    </label>
    <label>
        Pay Schedule
        <select name="paySchedule">
            <%
            paySchedules.forEach(schedule => { %>
            <option value="<%= schedule %>" <% if(budget.paySchedule === schedule) { %> selected <% } %>>
                <%= schedule %>
            </option>
            <%
            });
            %>
        </select>
    </label>
    <button type="submit">Update</button>
</form>

<br />

<h3>Bills</h3>

<%
if(budget.bills.length > 0) { %>

<table>
    <thead>
        <tr align="left">
            <th>Bill</th>
            <th>Due Date</th>
            <th align="right">Total</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <% budget.bills.forEach(bill => { %>
        <tr>
            <td><%= bill.name %></td>
            <td><%= bill.dueDate %></td>
            <td align="right">$<%= bill.total.toFixed(2) %></td>
            <td>
                <% if(bill.url) { %>
                <a href="<%= bill.url %>" target="_blank">Pay Bill</a>
                <% } %>
                <a href="/bills/<%= bill.id %>">Update</a>
            </td>
        </tr>
        <%
            });
            %>
    </tbody>
</table>

<br />

<%
} else { %>

<p>No bills yet. Add one to get started 🤘🏼</p>

<%
}
%>

<a href="/budgets/<%= budget.id %>/bills/new">Add a Bill</a>

<%- include('../partials/footer') %>